<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Open Library - Form Testing</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles/index.css">
  <script type="module" src="/src/components/index.js"></script>
  <style>
    .test-section {
      margin-bottom: var(--spacing-section);
      padding-bottom: var(--spacing-section);
      border-bottom: var(--border-width-divider) solid var(--color-border-default);
    }

    .test-results {
      margin-top: var(--spacing-4);
      padding: var(--spacing-3);
      background-color: var(--color-surface-secondary);
      border-radius: var(--radius-card);
      border-left: 4px solid var(--color-primary);
    }

    .test-results.hidden {
      display: none;
    }

    .test-results h4 {
      margin-top: 0;
      color: var(--color-primary);
    }

    .data-output {
      font-family: monospace;
      background-color: var(--color-surface-primary);
      padding: var(--spacing-2);
      border-radius: var(--radius-input);
      margin-top: var(--spacing-2);
    }

    .data-item {
      display: flex;
      gap: var(--spacing-2);
      padding: var(--spacing-1) 0;
    }

    .data-item strong {
      color: var(--color-primary);
      min-width: 100px;
    }

    .keyboard-hint {
      font-size: var(--font-body-sm-size);
      color: var(--color-text-secondary);
      padding: var(--spacing-2);
      background-color: var(--color-surface-tertiary);
      border-radius: var(--radius-input);
      margin-top: var(--spacing-2);
    }

    .keyboard-hint kbd {
      display: inline-block;
      padding: 2px 6px;
      background-color: var(--color-surface-primary);
      border: 1px solid var(--color-border);
      border-radius: 4px;
      font-family: monospace;
      font-size: 0.9em;
    }

    .accessibility-tests {
      margin-top: var(--spacing-3);
      padding: var(--spacing-3);
      background-color: var(--color-surface-tertiary);
      border-radius: var(--radius-card);
    }

    .test-checklist {
      list-style: none;
      padding: 0;
    }

    .test-checklist li {
      padding: var(--spacing-1) 0;
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-2);
    }

    .test-checklist li::before {
      content: "✓";
      color: var(--color-primary);
      font-weight: bold;
    }

    .event-log {
      margin-top: var(--spacing-3);
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      font-size: var(--font-body-sm-size);
      background-color: var(--color-surface-primary);
      padding: var(--spacing-2);
      border-radius: var(--radius-input);
    }

    .event-log-item {
      padding: 2px 0;
      border-bottom: 1px solid var(--color-border);
    }

    .event-log-item:last-child {
      border-bottom: none;
    }

    .event-type {
      color: var(--color-primary);
      font-weight: bold;
    }

    .event-timestamp {
      color: var(--color-text-secondary);
      font-size: 0.9em;
    }
  </style>
  <script type="module">
    document.addEventListener('DOMContentLoaded', () => {
      setupFormTests();
    });

    function setupFormTests() {
      // Test 1: Basic Form Submission
      const basicForm = document.getElementById('basic-form');
      const basicResults = document.getElementById('basic-results');
      const basicOutput = document.getElementById('basic-output');

      basicForm.addEventListener('submit', (e) => {
        e.preventDefault();

        // Get form data using FormData API
        const formData = new FormData(basicForm);
        const data = Object.fromEntries(formData.entries());

        // Display results
        basicResults.classList.remove('hidden');
        basicOutput.innerHTML = Object.entries(data)
          .map(([key, value]) => `
            <div class="data-item">
              <strong>${key}:</strong>
              <span>${value || '(empty)'}</span>
            </div>
          `)
          .join('');

        logEvent('basic', 'submit', data);
      });

      // Test 2: Multiple Fields with Validation
      const validationForm = document.getElementById('validation-form');
      const validationResults = document.getElementById('validation-results');
      const validationOutput = document.getElementById('validation-output');

      validationForm.addEventListener('submit', (e) => {
        e.preventDefault();

        const formData = new FormData(validationForm);
        const data = Object.fromEntries(formData.entries());

        validationResults.classList.remove('hidden');
        validationOutput.innerHTML = Object.entries(data)
          .map(([key, value]) => `
            <div class="data-item">
              <strong>${key}:</strong>
              <span>${value || '(empty)'}</span>
            </div>
          `)
          .join('');

        logEvent('validation', 'submit', data);
      });

      // Test 3: Event Logging
      const eventForm = document.getElementById('event-form');
      const eventLog = document.getElementById('event-log');
      const eventInput = eventForm.querySelector('ol-input');

      // Log input events
      eventInput.addEventListener('input', (e) => {
        logEventToUI(eventLog, 'input', e.target.value);
      });

      eventInput.addEventListener('change', (e) => {
        logEventToUI(eventLog, 'change', e.target.value);
      });

      eventInput.addEventListener('focus', (e) => {
        logEventToUI(eventLog, 'focus', 'Input focused');
      });

      eventInput.addEventListener('blur', (e) => {
        logEventToUI(eventLog, 'blur', 'Input blurred');
      });

      eventForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(eventForm);
        const data = Object.fromEntries(formData.entries());
        logEventToUI(eventLog, 'submit', JSON.stringify(data));
      });

      eventForm.addEventListener('reset', (e) => {
        logEventToUI(eventLog, 'reset', 'Form was reset');
      });

      // Test 4: Reset functionality
      const resetForm = document.getElementById('reset-form');

      resetForm.addEventListener('reset', (e) => {
        logEvent('reset', 'reset', 'Form was reset');
        setTimeout(() => {
          console.log('Form values after reset:',
            Object.fromEntries(new FormData(resetForm).entries())
          );
        }, 0);
      });
    }

    function logEvent(formId, eventType, data) {
      console.log(`[${formId}] ${eventType}:`, data);
    }

    function logEventToUI(logElement, eventType, data) {
      const timestamp = new Date().toLocaleTimeString();
      const logItem = document.createElement('div');
      logItem.className = 'event-log-item';
      logItem.innerHTML = `
        <span class="event-timestamp">${timestamp}</span>
        <span class="event-type">${eventType}</span>: ${data}
      `;
      logElement.insertBefore(logItem, logElement.firstChild);

      // Keep only last 20 events
      while (logElement.children.length > 20) {
        logElement.removeChild(logElement.lastChild);
      }
    }
  </script>
</head>
<body>

  <ol-main-nav></ol-main-nav>

  <main>
    <ol-section>
      <ol-heading element="h1" size="display-2">Form Component Testing</ol-heading>
    </ol-section>

    <!-- Test 1: Event Logging -->
    <ol-section>
      <div class="test-section">
        <ol-heading element="h2" size="title-2">Test 1: Event Logging</ol-heading>
        <p>Monitor all input events (input, change, focus, blur, submit).</p>

        <form id="event-form">
          <ol-field label="Test Input" hint="Type here and watch events below">
            <ol-input
              name="test_input"
              placeholder="Start typing...">
            </ol-input>
          </ol-field>

          <ol-button-group>
            <ol-button type="submit" slot="primary-action">Submit</ol-button>
            <ol-button type="reset" variant="secondary" slot="secondary-actions">Reset</ol-button>
          </ol-button-group>
        </form>

        <h4>Event Log (newest first):</h4>
        <div id="event-log" class="event-log">
          <div style="color: var(--color-text-secondary); font-style: italic;">
            No events yet. Interact with the input above.
          </div>
        </div>

      </div>
    </ol-section>

    <!-- Test 2: Basic Form Submission -->
    <ol-section>
      <div class="test-section">
        <ol-heading element="h2" size="title-2">Test 2: Basic Form Submission</ol-heading>
        <p>Tests if form submission captures input data correctly.</p>

        <form id="basic-form">
          <ol-field label="Username" hint="Enter your username" required>
            <ol-input
              name="username"
              placeholder="Enter username"
              autocomplete="username"
              required>
            </ol-input>
          </ol-field>

          <ol-button-group>
            <ol-button type="submit" slot="primary-action">Submit Form</ol-button>
          </ol-button-group>
        </form>

        <div id="basic-results" class="test-results hidden">
          <h4>✓ Form Submitted Successfully!</h4>
          <div class="data-output" id="basic-output"></div>
        </div>
      </div>
    </ol-section>

    <!-- Test 3: Multiple Fields with Validation -->
    <ol-section>
      <div class="test-section">
        <ol-heading element="h2" size="title-2">Test 3: Multiple Fields & Validation</ol-heading>
        <p>Tests multiple inputs with required validation.</p>

        <form id="validation-form">
          <ol-field label="Email Address" hint="We'll never share your email" required>
            <ol-input
              name="email"
              type="email"
              placeholder="you@example.com"
              autocomplete="email"
              required>
            </ol-input>
          </ol-field>

          <ol-field label="Password" hint="Must be at least 8 characters" required>
            <ol-input
              name="password"
              type="password"
              placeholder="Enter password"
              autocomplete="new-password"
              required>
            </ol-input>
          </ol-field>

          <ol-field label="Favorite Book" hint="Optional field">
            <ol-input
              name="favorite_book"
              placeholder="Enter book title">
            </ol-input>
          </ol-field>

          <ol-button-group>
            <ol-button type="submit" slot="primary-action">Create Account</ol-button>
          </ol-button-group>
        </form>

        <div id="validation-results" class="test-results hidden">
          <h4>✓ Form Submitted Successfully!</h4>
          <div class="data-output" id="validation-output"></div>
        </div>

      </div>
    </ol-section>

    <!-- Test 4: Form Reset -->
    <ol-section>
      <div class="test-section">
        <ol-heading element="h2" size="title-2">Test 4: Form Reset</ol-heading>
        <p>Tests form reset functionality with both submit and reset buttons.</p>

        <form id="reset-form">
          <ol-field label="Name" hint="Enter your name">
            <ol-input
              name="name"
              placeholder="John Doe">
            </ol-input>
          </ol-field>

          <ol-field label="Library Card Number">
            <ol-input
              name="card_number"
              placeholder="12345">
            </ol-input>
          </ol-field>

          <ol-button-group>
            <ol-button type="submit" slot="primary-action">Submit</ol-button>
            <ol-button type="reset" variant="secondary" slot="secondary-actions">Reset Form</ol-button>
          </ol-button-group>
        </form>

      </div>
    </ol-section>
  </main>
</body>
</html>

